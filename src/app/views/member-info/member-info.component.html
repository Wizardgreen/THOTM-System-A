<app-spinner [enable]="ready === false"></app-spinner>

<app-page-wrapper [hidden]="ready === false">
  <mat-accordion>
    <mat-expansion-panel [expanded]="defaultSection === null">
      <mat-expansion-panel-header>
        <mat-panel-title>個人資料</mat-panel-title>
      </mat-expansion-panel-header>
      <!-- TODO:將這塊程式碼拆成子元件 -->
      <form class="form-container form-basic-info" [formGroup]="profile">
        <app-row>
          <mat-form-field appearance="standard">
            <mat-label>姓名</mat-label>
            <input matInput required formControlName="name" />
          </mat-form-field>
          <mat-form-field appearance="standard">
            <mat-label>暱稱</mat-label>
            <input matInput formControlName="nickname" />
          </mat-form-field>
        </app-row>
        <mat-form-field appearance="standard">
          <mat-label>生日</mat-label>
          <input
            matInput
            formControlName="birthday"
            [matDatepicker]="birthdayPicker"
            (dateChange)="handleDateChange($event, 'birthday')"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="birthdayPicker"
          ></mat-datepicker-toggle>
          <mat-datepicker #birthdayPicker></mat-datepicker>
        </mat-form-field>
        <app-row>
          <mat-form-field appearance="standard">
            <mat-label>Line ID</mat-label>
            <input matInput required formControlName="lineId" />
          </mat-form-field>
          <mat-form-field appearance="standard">
            <mat-label>手機</mat-label>
            <input matInput required formControlName="phone" />
          </mat-form-field>
        </app-row>
        <app-row>
          <mat-form-field appearance="standard">
            <mat-label>居住地</mat-label>
            <mat-select formControlName="city">
              <mat-optgroup
                *ngFor="let group of locationList"
                [label]="group.groupName"
              >
                <mat-option
                  *ngFor="let location of group.list"
                  [value]="location"
                >
                  {{ location }}
                </mat-option>
              </mat-optgroup>
            </mat-select>
          </mat-form-field>
          <mat-form-field appearance="standard">
            <mat-label>電子信箱</mat-label>
            <input
              matInput
              placeholder="pat@example.com"
              formControlName="email"
            />
          </mat-form-field>
        </app-row>
        <mat-form-field appearance="standard">
          <mat-label>加入日期</mat-label>
          <input
            matInput
            [matDatepicker]="joinDatePicker"
            formControlName="joinDate"
            (dateChange)="handleDateChange($event, 'joinDate')"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="joinDatePicker"
          ></mat-datepicker-toggle>
          <mat-datepicker #joinDatePicker> </mat-datepicker>
        </mat-form-field>
        <mat-checkbox formControlName="hasCard">已領取會員證</mat-checkbox>
      </form>
      <button
        class="btn-apply"
        mat-flat-button
        color="warn"
        (click)="updateMemberBasicInfo()"
      >
        修改
      </button>
    </mat-expansion-panel>
    <mat-expansion-panel [expanded]="defaultSection === 'program'">
      <mat-expansion-panel-header>
        <mat-panel-title> 會籍 </mat-panel-title>
      </mat-expansion-panel-header>
      <app-panel-content-program
        [programList]="programList"
        [currentProgram]="currentProgram"
        [historyProgram]="historyProgram"
        (updateProgramDialogRequest)="openUpdateProgramDialog()"
        (cancelProgramDialogRequest)="openCancelProgramDialog()"
      ></app-panel-content-program>
    </mat-expansion-panel>
    <mat-expansion-panel [expanded]="defaultSection === 'storage'">
      <mat-expansion-panel-header>
        <mat-panel-title> 櫃位 </mat-panel-title>
      </mat-expansion-panel-header>
      <app-panel-content-storage
        [memberID]="memberID"
        [visualizeStorage]="visualizeStorage"
        (showDialogEvent)="openStorageDialog($event)"
      ></app-panel-content-storage>
    </mat-expansion-panel>
    <mat-expansion-panel [expanded]="false" disabled>
      <mat-expansion-panel-header>
        <mat-panel-title> 遊戲 (尚未開放)</mat-panel-title>
      </mat-expansion-panel-header>
      <p>I'm visible because I am open</p>
    </mat-expansion-panel>
    <mat-expansion-panel [expanded]="false" disabled>
      <mat-expansion-panel-header>
        <mat-panel-title> 未到商品 (尚未開放)</mat-panel-title>
      </mat-expansion-panel-header>
      <p>I'm visible because I am open</p>
    </mat-expansion-panel>
  </mat-accordion>
</app-page-wrapper>
